import socket
import rsa

UDP_IP = "127.0.0.1"
UDP_PORT = 5005

sock = socket.socket(socket.AF_INET, # Internet
                     socket.SOCK_DGRAM) # UDP

sock.bind((UDP_IP, UDP_PORT))

key = rsa.PublicKey(21035957629812277469157023951177435499284166259417544087658195877880578620983173211571334387494125440000892130166095509238412070914290596956356560851687514386813862027031596643008286683377981875688299390798157041917212097275882170019324673058614859852346677681919854682515697468170852179832753697555288309457923811967208005567580223963487756699691907346933956333003965845833667830193820850997386792156017632719438149524045822156633845513711283776284456859198606305178172516722259677633234771085500549467381174528770855743944283212245821192814529600475149085814262329263304674266778556044094458824193904483620276214493, 3)

print("trusted public key:", key.e)

message = sock.recv(4096)
sig = sock.recv(4096)
if rsa.verify(message, sig, key):
    print("I trust your message:", message.decode("ASCII"))
else:
    print("I don't trust your message")
